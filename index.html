<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>E1C é»åç³»çµ± (å®Œæ•´å­¸è™Ÿç‰ˆ)</title>
    <style>
        :root {
            --present-bg: #d4edda; --present-text: #155724;
            --absent-bg: #f8d7da; --absent-text: #721c24;
            --normal-bg: #ffffff;
        }
        body { font-family: -apple-system, sans-serif; background: #f0f2f5; margin: 0; padding: 15px; display: flex; flex-direction: column; align-items: center; padding-bottom: 50px; }
        
        .header { position: sticky; top: 0; z-index: 100; width: 100%; max-width: 500px; background: #343a40; color: white; padding: 15px; border-radius: 0 0 12px 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); margin-bottom: 20px; text-align: center; box-sizing: border-box; }
        .stats { display: flex; justify-content: space-around; margin-top: 10px; font-size: 14px; }
        .stats span { font-weight: bold; font-size: 18px; color: #ffc107; }

        .btn-group { display: flex; gap: 10px; width: 100%; max-width: 500px; margin-bottom: 15px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .btn-reset { background: #6c757d; color: white; }
        .btn-all-p { background: #28a745; color: white; }
        .btn-export { background: #007bff; color: white; width: 100%; max-width: 500px; margin-top: 20px; }

        .student-list { width: 100%; max-width: 500px; display: flex; flex-direction: column; gap: 8px; }
        .student-card { 
            display: flex; align-items: center; justify-content: space-between;
            padding: 15px; background: var(--normal-bg); border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05); border: 1px solid #ddd;
        }
        .student-info { display: flex; flex-direction: column; }
        .student-id { font-size: 12px; color: #888; }
        .student-name { font-size: 18px; font-weight: bold; }
        
        .student-card.present { background: var(--present-bg); color: var(--present-text); border-color: #c3e6cb; }
        .student-card.absent { background: var(--absent-bg); color: var(--absent-text); border-color: #f5c6cb; }
        
        .export-area { width: 100%; max-width: 500px; margin-top: 20px; display: none; background: white; padding: 15px; border-radius: 12px; border: 1px solid #ddd; box-sizing: border-box; }
        #reportContent { width: 100%; height: 250px; font-family: monospace; font-size: 13px; margin-top: 10px; border: 1px solid #eee; padding: 10px; box-sizing: border-box; background: #fafafa; line-height: 1.5; }
    </style>
</head>
<body>

    <div class="header">
        <div style="font-size: 18px; font-weight: bold;">ğŸ« E1C é»åç®¡ç†ç³»çµ±</div>
        <div class="stats">
            <div>æ‡‰åˆ°: <span>56</span></div>
            <div>å¯¦åˆ°: <span id="pCount">0</span></div>
            <div>ç¼ºå¸­: <span id="aCount">0</span></div>
        </div>
    </div>

    <div class="btn-group">
        <button class="btn-all-p" onclick="markAllPresent()">âœ… å…¨é«”å‡ºå¸­</button>
        <button class="btn-reset" onclick="resetRoll()">ğŸ§¹ æ¸…ç©º</button>
    </div>

    <div class="student-list" id="list"></div>

    <button class="btn-export" onclick="generateReport()">ğŸ“‹ ç”¢ç”Ÿæˆç¸¾/å‡ºå¸­åå–®</button>

    <div class="export-area" id="exportArea">
        <div style="font-weight: bold; font-size: 14px;">ç”¢å‡ºçš„åå–® (å«å®Œæ•´å­¸è™Ÿ)ï¼š</div>
        <textarea id="reportContent" readonly></textarea>
        <button onclick="copyReport()" style="background: #333; color: white; width: 100%; margin-top: 10px;">é»æ“Šè¤‡è£½æ–‡å­—</button>
        <button onclick="closeReport()" style="background: transparent; color: #999; width: 100%; margin-top: 5px; font-size: 12px;">é—œé–‰è¦–çª—</button>
    </div>

    <script>
        const students = [
            {id:"1114300121", n:"é¾”æ˜±ç‘„"}, {id:"1114300122", n:"ä½™æ²›å®¹"}, {id:"1114300123", n:"é™³æ¹˜ç”¯"}, {id:"1114300124", n:"æ—æ²æ¦†"}, {id:"1114300125", n:"è•­ç¾½å½¤"}, {id:"1114300126", n:"æ—å¥•å¸†"}, {id:"1114300127", n:"é™³ä¹™ç‘„"}, {id:"1114300128", n:"ç‹æ¼†å¦¤"}, {id:"1114300129", n:"é™³éœå®œ"}, {id:"1114300130", n:"é™³ç¥‰æ©"}, {id:"1114300131", n:"é™³åˆç‘„"}, {id:"1114300132", n:"è³´å®¥ç’‡"}, {id:"1114300133", n:"é™³çŸæ…ˆ"}, {id:"1114300134", n:"æ±ŸèŠ¯èª"}, {id:"1114300135", n:"é™³ä¸–è±ª"}, {id:"1114300136", n:"æ›¾å®‰å²‘"}, {id:"1114300137", n:"è³´ç‘¾å®‰"}, {id:"1114300138", n:"ç¾…å‡±çˆ¾"}, {id:"1114300139", n:"è¾›ä¿Šæ–‡"}, {id:"1114300140", n:"é»ƒé–æ™"}, {id:"1114300141", n:"æ—ç´«é¨"}, {id:"1114300142", n:"å³éœˆç‘œ"}, {id:"1114300143", n:"è¨±å”¯èŠ¯"}, {id:"1114300144", n:"éŠèŠ¯èª"}, {id:"1114300145", n:"ææ˜“æ˜Œ"}, {id:"1114300146", n:"æå©•ç¦•"}, {id:"1114300147", n:"ææ©å¦®"}, {id:"1114300148", n:"æ—é‡‘å§µ"}, {id:"1114300149", n:"é™³å¯ç´œ"}, {id:"1114300151", n:"å¼µé›…çŸ"}, {id:"1114300152", n:"ç‰›æ˜±ç¿”"}, {id:"1114300153", n:"é™³ä»¥å©•"}, {id:"1114300154", n:"å¼µéˆºå©•"}, {id:"1114300155", n:"æœ±é›¯èŠ³"}, {id:"1114300156", n:"é€£å­ç”¯"}, {id:"1114300157", n:"æ¥ŠèŠ·èŠ¹"}, {id:"1114300158", n:"é™³ç¦æ¶µ"}, {id:"1114300159", n:"é™³å† å®‡"}, {id:"1114300160", n:"é™³æ¼¢åº­"}, {id:"1114300161", n:"å¼µä¹™èŠ¹"}, {id:"1114300162", n:"ç‹å¦è»"}, {id:"1114300163", n:"æ›²å­å¯¬"}, {id:"1114300164", n:"ç‹ä»¥å€«"}, {id:"1114300165", n:"è¶™äºå«»"}, {id:"1114300166", n:"æ—å®œæ¨º"}, {id:"1114300167", n:"æŸ¯å“ç‘€"}, {id:"1114300168", n:"å“å½¥å‡"}, {id:"1114300169", n:"éŠæ¢å¥é›…"}, {id:"1114300170", n:"å¼µå­ç‘œ"}, {id:"1114300171", n:"å¼µæ¹˜ç¿Š"}, {id:"1114300172", n:"å»–éšè–‡"}, {id:"1114300173", n:"é»ƒæ¯“éœ"}, {id:"1114300174", n:"è”¡æ‚…ç³"}, {id:"1114300175", n:"é™³å®¥å‰"}, {id:"1114300501", n:"è³ˆä¼¯ç"}, {id:"1114300502", n:"é„­çš“è»’"}
        ];

        let rollStatus = JSON.parse(localStorage.getItem('e1c_roll_call')) || students.map(s => ({id: s.id, st: 'u'}));

        function render() {
            const list = document.getElementById('list');
            list.innerHTML = '';
            let p = 0, a = 0;

            students.forEach((s, i) => {
                const status = rollStatus[i].st;
                const card = document.createElement('div');
                card.className = `student-card ${status==='p'?'present':''} ${status==='a'?'absent':''}`;
                card.onclick = () => { rollStatus[i].st = (status==='u'?'p':(status==='p'?'a':'u')); render(); };
                
                if(status==='p') p++;
                if(status==='a') a++;

                card.innerHTML = `
                    <div class="student-info">
                        <span class="student-id">${s.id}</span>
                        <span class="student-name">${s.n}</span>
                    </div>
                    <div style="font-size:12px; font-weight:bold;">${status==='p'?'âœ”ï¸å‡ºå¸­':(status==='a'?'âŒç¼ºå¸­':'--')}</div>
                `;
                list.appendChild(card);
            });

            document.getElementById('pCount').innerText = p;
            document.getElementById('aCount').innerText = a;
            localStorage.setItem('e1c_roll_call', JSON.stringify(rollStatus));
        }

        function generateReport() {
            const now = new Date();
            const timeStr = `${now.getFullYear()}/${now.getMonth()+1}/${now.getDate()} é»åç´€éŒ„`;
            const presentList = students.filter((s, i) => rollStatus[i].st === 'p').map(s => `${s.id} ${s.n}`);
            const absentList = students.filter((s, i) => rollStatus[i].st === 'a').map(s => `${s.id} ${s.n}`);

            let report = `ã€${timeStr}ã€‘\n`;
            report += `å¯¦åˆ°ç¸½æ•¸ï¼š${presentList.length} äºº\n\n`;
            report += `--- å‡ºå¸­åå–® (${presentList.length}äºº) ---\n`;
            report += presentList.length > 0 ? presentList.join('\n') : '(ç„¡äººå‡ºå¸­)';
            report += `\n\n--- ç¼ºå¸­åå–® (${absentList.length}äºº) ---\n`;
            report += absentList.length > 0 ? absentList.join('\n') : '(ç„¡äººç¼ºå¸­)';

            document.getElementById('reportContent').value = report;
            document.getElementById('exportArea').style.display = 'block';
            window.scrollTo(0, document.body.scrollHeight);
        }

        function copyReport() {
            const content = document.getElementById('reportContent');
            content.select();
            document.execCommand('copy');
            alert('åŒ…å«å­¸è™Ÿçš„åå–®å·²è¤‡è£½ï¼');
        }

        function closeReport() { document.getElementById('exportArea').style.display = 'none'; }
        function markAllPresent() { rollStatus = students.map(s => ({id: s.id, st: 'p'})); render(); }
        function resetRoll() { if(confirm('é‡ç½®é»åç´€éŒ„ï¼Ÿ')) { rollStatus = students.map(s => ({id: s.id, st: 'u'})); render(); } }

        render();
    </script>
</body>
</html>
